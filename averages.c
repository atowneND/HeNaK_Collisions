#include <fcntl.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include "avgFun.h"

int main(){
    double theta[MAXDATA];
    double B[MAXDATA];
    double Bsin[MAXDATA];
    double data[MAXDATA][2] = {
{       0.0,   104.5559132},
{       2.0,    93.9786283},
{       4.0,    67.4466265},
{       6.0,    37.1250974},
{       8.0,    14.4740582},
{      10.0,     4.0326978},
{      12.0,     2.7505718},
{      14.0,     4.3185331},
{      16.0,     4.3425714},
{      18.0,     2.4308577},
{      20.0,     0.5598512},
{      22.0,     0.1877512},
{      24.0,     0.9237466},
{      26.0,     1.4253459},
{      28.0,     1.0042648},
{      30.0,     0.1662294},
{      32.0,    -0.2043294},
{      34.0,     0.1232100},
{      36.0,     0.5960509},
{      38.0,     0.6136603},
{      40.0,     0.1880417},
{      42.0,    -0.1698520},
{      44.0,    -0.0923207},
{      46.0,     0.2544661},
{      48.0,     0.4256866},
{      50.0,     0.2312392},
{      52.0,    -0.0805299},
{      54.0,    -0.1529055},
{      56.0,     0.0627308},
{      58.0,     0.2821501},
{      60.0,     0.2441723},
{      62.0,     0.0076422},
{      64.0,    -0.1432169},
{      66.0,    -0.0441189},
{      68.0,     0.1684047},
{      70.0,     0.2358187},
{      72.0,     0.0850901},
{      74.0,    -0.0980916},
{      76.0,    -0.1003273},
{      78.0,     0.0694092},
{      80.0,     0.2015684},
{      82.0,     0.1403578},
{      84.0,    -0.0364132},
{      86.0,    -0.1181165},
{      88.0,    -0.0134055},
{      90.0,     0.1467158},
{      92.0,     0.1700459},
{      94.0,     0.0311016},
{      96.0,    -0.1034304},
{      98.0,    -0.0759530},
{     100.0,     0.0762785},
{     102.0,     0.1690699},
{     104.0,     0.0917268},
{     106.0,    -0.0629796},
{     108.0,    -0.1113927},
{     110.0,     0.0020572},
{     112.0,     0.1397727},
{     114.0,     0.1358308},
{     116.0,    -0.0059747},
{     118.0,    -0.1164056},
{     120.0,    -0.0626218},
{     122.0,     0.0921154},
{     124.0,     0.1619300},
{     126.0,     0.0599010},
{     128.0,    -0.0952094},
{     130.0,    -0.1170720},
{     132.0,     0.0254154},
{     134.0,     0.1657591},
{     136.0,     0.1339431},
{     138.0,    -0.0385538},
{     140.0,    -0.1486745},
{     142.0,    -0.0596207},
{     144.0,     0.1307842},
{     146.0,     0.1969152},
{     148.0,     0.0520630},
{     150.0,    -0.1381021},
{     152.0,    -0.1411343},
{     154.0,     0.0630391},
{     156.0,     0.2408751},
{     158.0,     0.1699827},
{     160.0,    -0.0856457},
{     162.0,    -0.2230581},
{     164.0,    -0.0458162},
{     166.0,     0.2776584},
{     168.0,     0.3659968},
{     170.0,     0.0608166},
{     172.0,    -0.3284665},
{     174.0,    -0.2835293},
{     176.0,     0.3818559},
{     178.0,     1.2573742},
{     180.0,     1.6598036},
     };

    int i;
    double sum = 0;
    for (i=0;i<MAXDATA;i++){
        theta[i] = data[i][0]*PI/180;
        B[i] = data[i][1];
        Bsin[i] = theta[i]*B[i];
    }

    double avgB = fmean(B);
    printf("avgB = %f\n",avgB);
    avgB = fmean(Bsin);
    printf("avgBsin = %f\n",avgB);

    double avgTheta = expvals(theta,B,0);
    double varTheta = expvals(theta,B,1);
    double stdTheta = expvals(theta,B,2);
    printf("Stats:\n\t<theta> = %f rad, %f deg.\n\tvar = %f\n\tstd = %f\n",avgTheta,avgTheta*180/PI,varTheta,stdTheta);
    int foo = 3;
    
    // test these functions
    // y = cos(x);
    int testnpoints = 1000;
    int p;
    double y[testnpoints], x[testnpoints];
    double avgx,varx,stdx;
    for (p=0;p<testnpoints;p++){
        x[p] = p*2*PI/testnpoints;
        y[p] = cos(x[p]);
        printf("%f %f\n",x[p],y[p]);
    }

    avgx = expvals(x,y,0);
    varx = expvals(x,y,1);
    stdx = expvals(x,y,2);
    printf("Stats:\n\t<x> = %f rad, %f deg.\n\tvar = %f\n\tstd = %f\n",avgx,avgx*180/PI,varx,stdx);
    
    return 0;
}

